openapi: 3.1.0
info:
  title: Fasting Plan Manager API
  description: API pre spr√°vu fasting pl√°nu s Google Sheets integr√°ciou. Umo≈æ≈àuje zaznamen√°va≈• fasting, pl√°nova≈• jedl√° a sledova≈• ≈°tatistiky.
  version: 1.0.0
servers:
  - url: https://your-app-name.up.railway.app
    description: Production server (Railway)
  - url: http://localhost:3000
    description: Local development server

paths:
  /health:
    get:
      summary: Health check
      description: Kontrola ƒçi API funguje
      operationId: healthCheck
      responses:
        '200':
          description: API funguje spr√°vne
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  timestamp:
                    type: string
                  service:
                    type: string

  /api/dnes:
    get:
      summary: Dne≈°n√Ω fasting pl√°n
      description: Vr√°ti dne≈°n√Ω fasting pl√°n (automaticky pri otvoren√≠ konverz√°cie)
      operationId: getDnesnyPlan
      responses:
        '200':
          description: Dne≈°n√Ω pl√°n
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object

  /api/fasting:
    get:
      summary: Z√≠skaj v≈°etky fasting z√°znamy
      description: Vr√°ti v≈°etky z√°znamy z Google Sheets (Fasting_Plan h√°rok)
      operationId: getAllFasting
      responses:
        '200':
          description: Zoznam v≈°etk√Ωch fasting z√°znamov
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  count:
                    type: integer
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/FastingRecord'
    
    post:
      summary: Aktualizuj existuj√∫ci fasting z√°znam
      description: Aktualizuje existuj√∫ci z√°znam v Google Sheets. Z√°znam mus√≠ u≈æ existova≈• (nie je mo≈æn√© prid√°va≈• nov√© riadky). Farba riadku sa automaticky zmen√≠ podƒæa stavu - Dokonƒçen√Ω (zelen√°), Vynechan√Ω (ƒçerven√°), Napl√°novan√Ω (≈ælt√°).
      operationId: updateFasting
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - datum
              properties:
                datum:
                  type: string
                  description: D√°tum vo form√°te DD.MM.YYYY
                  example: "30.10.2025"
                typFastingu:
                  type: string
                  description: Typ fastingu
                  example: "16:8"
                  enum: ["16:8", "18:6", "20:4", "24h", "Voƒæn√Ω de≈à"]
                casZaciatku:
                  type: string
                  description: ƒåas zaƒçiatku vo form√°te HH:MM
                  example: "20:00"
                casKonca:
                  type: string
                  description: ƒåas konca vo form√°te HH:MM
                  example: "12:00"
                dlzkaFastingu:
                  type: string
                  description: Dƒ∫≈æka v hodin√°ch
                  example: "16"
                stav:
                  type: string
                  enum: ["Napl√°novan√Ω", "Dokonƒçen√Ω", "Vynechan√Ω"]
                  example: "Dokonƒçen√Ω"
                hmotnost:
                  type: string
                  description: Hmotnos≈• v kg (slovensk√Ω form√°t s ƒçiarkou)
                  example: "78,5"
                energia:
                  type: string
                  description: Energia/pocit (1-10)
                  example: "8"
                poznamka:
                  type: string
                  description: Pozn√°mka
                  example: "C√≠tim sa v√Ωborne!"
      responses:
        '200':
          description: Z√°znam bol √∫spe≈°ne aktualizovan√Ω
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/FastingRecord'
        '404':
          description: D√°tum nebol n√°jden√Ω v pl√°ne (riadok mus√≠ u≈æ existova≈• v Google Sheets)

  /api/fasting/{datum}:
    get:
      summary: Z√≠skaj detail fasting d≈àa
      description: Vr√°ti detail z√°znamu pre konkr√©tny d√°tum
      operationId: getFastingByDate
      parameters:
        - name: datum
          in: path
          required: true
          description: D√°tum vo form√°te DD.MM.YYYY
          schema:
            type: string
          example: "30.10.2025"
      responses:
        '200':
          description: Detail z√°znamu
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/FastingRecord'
        '404':
          description: Z√°znam nebol n√°jden√Ω

  /api/oznac-den:
    post:
      summary: Oznaƒç de≈à ako splnen√Ω/nesplnen√Ω
      description: Jednoduch√Ω endpoint pre ChatGPT na oznaƒçenie d≈àa. Ak splnene=true, nastav√≠ stav na Dokonƒçen√Ω a farbu na zelen√∫. Ak splnene=false, nastav√≠ stav na Vynechan√Ω a farbu na ƒçerven√∫. Perfektn√© pre veƒçern√Ω check-in.
      operationId: oznacDen
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - datum
                - splnene
              properties:
                datum:
                  type: string
                  description: D√°tum vo form√°te DD.MM.YYYY
                  example: "30.10.2025"
                splnene:
                  type: boolean
                  description: True = splnen√© (zelen√°), False = nesplnen√© (ƒçerven√°)
                  example: true
                hmotnost:
                  type: string
                  description: Hmotnos≈• v kg (slovensk√Ω form√°t s ƒçiarkou)
                  example: "78,5"
                energia:
                  type: string
                  description: Energia/pocit (1-10)
                  example: "8"
                poznamka:
                  type: string
                  description: Pozn√°mka
                  example: "V√Ωborne som to zvl√°dol!"
      responses:
        '200':
          description: De≈à bol √∫spe≈°ne oznaƒçen√Ω a farba zmenen√°
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                    example: "‚úÖ Gratulujem! De≈à 30.10.2025 bol oznaƒçen√Ω ako splnen√Ω (zelen√°)"
                  data:
                    type: object
                    properties:
                      datum:
                        type: string
                      stav:
                        type: string
                        enum: ["Dokonƒçen√Ω", "Vynechan√Ω"]
                      splnene:
                        type: boolean
                      farba:
                        type: string
                        example: "zelen√° üü¢"
        '404':
          description: D√°tum nebol n√°jden√Ω v pl√°ne

  /api/jedlo:
    get:
      summary: Z√≠skaj v≈°etky pl√°novan√© jedl√°
      description: Vr√°ti v≈°etky pl√°novan√© jedl√° z Google Sheets (Planovane_Jedlo h√°rok)
      operationId: getAllJedlo
      responses:
        '200':
          description: Zoznam pl√°novan√Ωch jed√°l
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  count:
                    type: integer
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/JedloRecord'
    
    post:
      summary: Pridaj pl√°novan√© jedlo
      description: Prid√° nov√© jedlo do pl√°nu
      operationId: createJedlo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - datum
                - casJedla
                - typJedla
                - nazovJedla
              properties:
                datum:
                  type: string
                  description: D√°tum vo form√°te DD.MM.YYYY
                  example: "30.10.2025"
                casJedla:
                  type: string
                  description: ƒåas jedla vo form√°te HH:MM
                  example: "13:00"
                typJedla:
                  type: string
                  enum: ["Ra≈àajky", "Obed", "Veƒçera", "Snack"]
                  example: "Obed"
                nazovJedla:
                  type: string
                  description: N√°zov jedla
                  example: "Kuracie prsia s ry≈æou"
                kalorie:
                  type: string
                  description: Kal√≥rie v kcal
                  example: "650"
                bielkoviny:
                  type: string
                  description: Bielkoviny v gramoch
                  example: "45"
                sacharidy:
                  type: string
                  description: Sacharidy v gramoch
                  example: "60"
                tuky:
                  type: string
                  description: Tuky v gramoch
                  example: "15"
                poznamka:
                  type: string
                  description: Pozn√°mka
                  example: "S brokolicou"
      responses:
        '200':
          description: Jedlo bolo √∫spe≈°ne pridan√©
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/JedloRecord'

  /api/statistiky:
    get:
      summary: Z√≠skaj celkov√© ≈°tatistiky
      description: Vr√°ti celkov√© ≈°tatistiky fastingu (√∫spe≈°nos≈•, priemern√° dƒ∫≈æka, trend hmotnosti)
      operationId: getStatistiky
      responses:
        '200':
          description: Celkov√© ≈°tatistiky
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      celkemZaznamov:
                        type: integer
                      dokoncene:
                        type: integer
                      vynechane:
                        type: integer
                      naplanovane:
                        type: integer
                      uspesnost:
                        type: string
                      celkoveHodinyFastingu:
                        type: string
                      priemernaDelkaFastingu:
                        type: string
                      trendHmotnosti:
                        type: string
                      aktualnaHmotnost:
                        type: string

  /api/analytics/tyzdenne:
    get:
      summary: T√Ω≈ædenn√Ω prehƒæad
      description: ≈†tatistiky za aktu√°lny t√Ω≈æde≈à
      operationId: getTyzdenneAnalytics
      responses:
        '200':
          description: T√Ω≈ædenn√© ≈°tatistiky
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  obdobie:
                    type: string
                  data:
                    type: object
                    properties:
                      celkemDni:
                        type: integer
                      dokoncentychDni:
                        type: integer
                      celkoveHodinyFastingu:
                        type: string
                      priemernaDelka:
                        type: string
                      uspesnost:
                        type: string

  /api/analytics/mesacne:
    get:
      summary: Mesaƒçn√Ω prehƒæad
      description: ≈†tatistiky za aktu√°lny mesiac
      operationId: getMesacneAnalytics
      responses:
        '200':
          description: Mesaƒçn√© ≈°tatistiky
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  obdobie:
                    type: string
                  data:
                    type: object
                    properties:
                      celkemDni:
                        type: integer
                      dokoncentychDni:
                        type: integer
                      celkoveHodinyFastingu:
                        type: string
                      priemernaDelka:
                        type: string
                      uspesnost:
                        type: string
                      najdlhsiFasting:
                        type: string
                      najdlhsiDen:
                        type: string

  /api/analytics/hmotnost:
    get:
      summary: Trend hmotnosti
      description: Vr√°ti trend hmotnosti s hist√≥riou meran√≠
      operationId: getHmotnostTrend
      responses:
        '200':
          description: Trend hmotnosti
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      pocetMerani:
                        type: integer
                      prvaHmotnost:
                        type: string
                      prveMeranie:
                        type: string
                      aktualnaHmotnost:
                        type: string
                      poslednem√©ranie:
                        type: string
                      zmena:
                        type: string
                      zmenaPercent:
                        type: string
                      trend:
                        type: string
                      historie:
                        type: array
                        items:
                          type: object
                          properties:
                            datum:
                              type: string
                            hmotnost:
                              type: string

components:
  schemas:
    FastingRecord:
      type: object
      properties:
        datum:
          type: string
          description: D√°tum (DD.MM.YYYY)
        denVTyzdni:
          type: string
          description: De≈à v t√Ω≈ædni
        typFastingu:
          type: string
          description: Typ fastingu
        casZaciatku:
          type: string
          description: ƒåas zaƒçiatku (HH:MM)
        casKonca:
          type: string
          description: ƒåas konca (HH:MM)
        dlzkaFastingu:
          type: string
          description: Dƒ∫≈æka fastingu v hodin√°ch
        stav:
          type: string
          description: Stav
        hmotnost:
          type: string
          description: Hmotnos≈• r√°no (kg)
        energia:
          type: string
          description: Energia/pocit (1-10)
        poznamka:
          type: string
          description: Pozn√°mka

    JedloRecord:
      type: object
      properties:
        datum:
          type: string
          description: D√°tum (DD.MM.YYYY)
        casJedla:
          type: string
          description: ƒåas jedla (HH:MM)
        typJedla:
          type: string
          description: Typ jedla
        nazovJedla:
          type: string
          description: N√°zov jedla
        kalorie:
          type: string
          description: Kal√≥rie (kcal)
        bielkoviny:
          type: string
          description: Bielkoviny (g)
        sacharidy:
          type: string
          description: Sacharidy (g)
        tuky:
          type: string
          description: Tuky (g)
        poznamka:
          type: string
          description: Pozn√°mka


